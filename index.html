<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–≤—ñ—Ç—Ä—è–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞ - –ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .safe {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .alert {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            animation: alertPulse 2s infinite;
        }

        .loading {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
        }

        .error {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            color: white;
        }

        @keyframes alertPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .container {
            text-align: center;
            padding: 2rem;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 500px;
            width: 90%;
            animation: slideIn 0.8s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .status-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .status-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .status-message {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .region-info {
            background: rgba(255, 255, 255, 0.2);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .region-name {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .last-update {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 1rem;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top: 5px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .refresh-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .background-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }

        .floating-element {
            position: absolute;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .alert-siren {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff1744;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            animation: sirenBlink 0.5s infinite;
            z-index: 1000;
        }

        @keyframes sirenBlink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .status-details {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 10px;
            margin-top: 1rem;
            text-align: left;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        @media (max-width: 600px) {
            .status-title {
                font-size: 2rem;
            }
            
            .status-icon {
                font-size: 3rem;
            }
            
            .container {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body class="loading">
    <div class="background-animation">
        <div class="floating-element" style="top: 10%; left: 10%; font-size: 2rem;">üõ°Ô∏è</div>
        <div class="floating-element" style="top: 20%; right: 15%; font-size: 1.5rem; animation-delay: -2s;">üè†</div>
        <div class="floating-element" style="bottom: 30%; left: 20%; font-size: 1.8rem; animation-delay: -4s;">üá∫üá¶</div>
        <div class="floating-element" style="bottom: 20%; right: 10%; font-size: 1.3rem; animation-delay: -1s;">üíô</div>
        <div class="floating-element" style="top: 50%; left: 5%; font-size: 1.6rem; animation-delay: -3s;">üíõ</div>
    </div>

    <div class="alert-siren" id="alertSiren">
        üö® –ü–û–í–Ü–¢–†–Ø–ù–ê –¢–†–ò–í–û–ì–ê! üö®
    </div>

    <div class="container">
        <div class="loading-spinner" id="loadingSpinner"></div>
        <div class="status-icon" id="statusIcon">‚è≥</div>
        <div class="status-title" id="statusTitle">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
        <div class="status-message" id="statusMessage">–û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø–æ–≤—ñ—Ç—Ä—è–Ω—É —Ç—Ä–∏–≤–æ–≥—É</div>
        
        <div class="region-info">
            <div class="region-name">–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</div>
            <div>–£–∫—Ä–∞—ó–Ω–∞</div>
        </div>

        <div class="status-details" id="statusDetails" style="display: none;">
            <div class="detail-item">
                <span>–°—Ç–∞—Ç—É—Å:</span>
                <span id="detailStatus">-</span>
            </div>
            <div class="detail-item">
                <span>–ß–∞—Å –ø–æ—á–∞—Ç–∫—É:</span>
                <span id="detailStartTime">-</span>
            </div>
            <div class="detail-item">
                <span>–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å:</span>
                <span id="detailDuration">-</span>
            </div>
        </div>

        <div class="last-update" id="lastUpdate">–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: -</div>
        
        <button class="refresh-btn" onclick="checkAlertStatus()">
            üîÑ –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å
        </button>
    </div>

    <script>
        let alertSound = null;
        let isAlertActive = false;

        const API_CONFIG = {
            API_KEY: '5255c8643c5e2c196969a33c52c79f58cece70bbab2203',
            BASE_URL: 'https://api.alerts.in.ua/v1/iot/active_air_raid_alerts',
            ZHYTOMYR_REGION_ID: '10'
        };

        function initAlertSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            function createBeep(frequency, duration) {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            }

            return {
                play: () => {
                    createBeep(800, 0.2);
                    setTimeout(() => createBeep(600, 0.2), 300);
                }
            };
        }

        async function checkAlertStatus() {
            const loadingSpinner = document.getElementById('loadingSpinner');
            const statusIcon = document.getElementById('statusIcon');
            const statusTitle = document.getElementById('statusTitle');
            const statusMessage = document.getElementById('statusMessage');
            const statusDetails = document.getElementById('statusDetails');
            const lastUpdate = document.getElementById('lastUpdate');
            const alertSiren = document.getElementById('alertSiren');

            document.body.className = 'loading';
            loadingSpinner.style.display = 'block';
            statusIcon.textContent = '‚è≥';
            statusTitle.textContent = '–û–Ω–æ–≤–ª–µ–Ω–Ω—è...';
            statusMessage.textContent = '–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Å—Ç–∞—Ç—É—Å –ø–æ–≤—ñ—Ç—Ä—è–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏';
            statusDetails.style.display = 'none';

            try {
                if (API_CONFIG.API_KEY === 'YOUR_API_KEY_HERE') {
                    throw new Error('API_KEY_NOT_SET');
                }

                const response = await fetch(`${API_CONFIG.BASE_URL}/${API_CONFIG.ZHYTOMYR_REGION_ID}.json`, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Authorization': `Bearer ${API_CONFIG.API_KEY}`
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const alertStatus = await response.text();
                const cleanStatus = alertStatus.replace(/['"]/g, '').trim();
                
                loadingSpinner.style.display = 'none';
                
                const isAlert = cleanStatus === 'A' || cleanStatus === 'P';
                
                if (isAlert) {
                    document.body.className = 'alert';
                    statusIcon.textContent = 'üö®';
                    
                    if (cleanStatus === 'A') {
                        statusTitle.textContent = '–ü–û–í–Ü–¢–†–Ø–ù–ê –¢–†–ò–í–û–ì–ê!';
                        statusMessage.textContent = '–ê–∫—Ç–∏–≤–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞ –ø–æ –≤—Å—ñ–π –æ–±–ª–∞—Å—Ç—ñ! –ù–µ–≥–∞–π–Ω–æ –ø—Ä–æ–π–¥—ñ—Ç—å –¥–æ —É–∫—Ä–∏—Ç—Ç—è!';
                    } else {
                        statusTitle.textContent = '–ß–ê–°–¢–ö–û–í–ê –¢–†–ò–í–û–ì–ê!';
                        statusMessage.textContent = '–¢—Ä–∏–≤–æ–≥–∞ –≤ –æ–∫—Ä–µ–º–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö –æ–±–ª–∞—Å—Ç—ñ. –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏!';
                    }
                    
                    alertSiren.style.display = 'block';
                    
                    statusDetails.style.display = 'block';
                    document.getElementById('detailStatus').textContent = cleanStatus === 'A' ? '–ê–ö–¢–ò–í–ù–ê' : '–ß–ê–°–¢–ö–û–í–ê';
                    document.getElementById('detailStartTime').textContent = '–î–∞–Ω—ñ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ';
                    document.getElementById('detailDuration').textContent = '–î–∞–Ω—ñ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ';
                    
                    if (!isAlertActive) {
                        if (!alertSound) {
                            alertSound = initAlertSound();
                        }
                        alertSound.play();
                        
                        const alertInterval = setInterval(() => {
                            if (isAlertActive) {
                                alertSound.play();
                            } else {
                                clearInterval(alertInterval);
                            }
                        }, 5000);
                    }
                    
                    isAlertActive = true;
                } else {
                    document.body.className = 'safe';
                    statusIcon.textContent = '‚úÖ';
                    statusTitle.textContent = '–ë–ï–ó–ü–ï–ß–ù–û';
                    statusMessage.textContent = '–ü–æ–≤—ñ—Ç—Ä—è–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏ –Ω–µ–º–∞—î. –ó–∞–ª–∏—à–∞–π—Ç–µ—Å—è –ø–∏–ª—å–Ω–∏–º–∏!';
                    alertSiren.style.display = 'none';
                    statusDetails.style.display = 'none';
                    isAlertActive = false;
                }
                
                lastUpdate.textContent = `–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: ${new Date().toLocaleString('uk-UA')}`;
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –¥–∞–Ω–∏—Ö:', error);
                
                loadingSpinner.style.display = 'none';
                
                if (error.message === 'API_KEY_NOT_SET') {
                    document.body.className = 'error';
                    statusIcon.textContent = 'üîë';
                    statusTitle.textContent = '–ü–û–¢–†–Ü–ë–ï–ù API –ö–õ–Æ–ß';
                    statusMessage.innerHTML = `
                        –î–ª—è —Ä–æ–±–æ—Ç–∏ —Å–∞–π—Ç—É –ø–æ—Ç—Ä—ñ–±–µ–Ω –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π API –∫–ª—é—á.<br>
                        <strong>–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó:</strong><br>
                        1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ <a href="https://devs.alerts.in.ua/" target="_blank" style="color: #FFE082;">devs.alerts.in.ua</a><br>
                        2. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–æ—Ä–º—É –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞<br>
                        3. –ó–∞–º—ñ–Ω—ñ—Ç—å 'YOUR_API_KEY_HERE' —É –∫–æ–¥—ñ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω<br>
                        4. API –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
                    `;
                } else {
                    document.body.className = 'error';
                    statusIcon.textContent = '‚ö†Ô∏è';
                    statusTitle.textContent = '–ü–û–ú–ò–õ–ö–ê';
                    statusMessage.textContent = '–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∞–±–æ —Å–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.';
                }
                
                statusDetails.style.display = 'none';
                alertSiren.style.display = 'none';
                
                lastUpdate.textContent = `–û—Å—Ç–∞–Ω–Ω—è —Å–ø—Ä–æ–±–∞: ${new Date().toLocaleString('uk-UA')}`;
            }
        }

        function startAutoUpdate() {
            setInterval(checkAlertStatus, 30000);
        }

        document.addEventListener('DOMContentLoaded', function() {
            checkAlertStatus();
            startAutoUpdate();
        });

        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                checkAlertStatus();
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space' || event.code === 'Enter') {
                event.preventDefault();
                checkAlertStatus();
            }
        });
    </script>
</body>
</html>

